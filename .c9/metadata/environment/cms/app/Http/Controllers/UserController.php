{"filter":false,"title":"UserController.php","tooltip":"/cms/app/Http/Controllers/UserController.php","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":10,"column":0},"action":"remove","lines":["<?php","","namespace App\\Http\\Controllers;","","use Illuminate\\Http\\Request;","","class UserController extends Controller","{","    //","}",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":33,"column":1},"action":"insert","lines":["<?php","namespace App\\Http\\Controllers;","use Illuminate\\Http\\Request;","use App\\User;","use Auth;","class UserController extends Controller","{","    //","    public function edit(){","        $user = User::find(Auth::id());","        return view('user.edit', ['user'=>$user]);","    }","    public function update(Request $request){","        $user = User::find(Auth::id());","        //画像名と拡張子を取得","        //調べたい人はvar_dump($request->file('profile_image'))するとよいです","        //画像のデータが送られてきた場合のみ、下記の処理を行う","        if($request->file('profile_image')){","            $file_name = $request->file('profile_image')->getClientOriginalName();","            $file_type = null;","            if($file_type[\"type\"] == \"image/png\"){","                $file_type = \".png\";","            }elseif($file_type[\"type\"] == \"image/jpng\"){","                $file_type = \".jpg\";","            }","            //画像を保存","            $filePath = $request->file(\"profile_image\")->storeAs('public/uploaded_image', $file_name . $file_type);","            $user->profile_image = str_replace('public/', '', $filePath);","        }","        //画像以外を保存","        $user->fill($request->except(\"profile_image\"))->save();","        return redirect('user/edit')->with(\"success\",\"ユーザーのプロフィール更新が完了しました。\");","    }","}"]}]]},"ace":{"folds":[],"scrolltop":284.0859375,"scrollleft":0,"selection":{"start":{"row":19,"column":30},"end":{"row":19,"column":30},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":18,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1566480061316,"hash":"0b20415d21fcc3f6c46900776acbb27d0c9d4e51"}